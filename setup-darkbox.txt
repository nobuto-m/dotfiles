install without swap

/etc/ssh/sshd_config
PasswordAuthentication no

sudo restart ssh


# with wired LAN
sudo sed -i -e 's/us.archive/archive/' /etc/apt/sources.list
sudo apt-get update
sudo apt-get install --no-install-recommends network-manager
sudo start network-manager
nmcli dev wifi list
sudo nmcli dev wifi connect <(B)SSID> password <password>

sudo apt-get install etckeeper

sudo apt-get install anacron
sudo apt-get purge apt-xapian-index

sudo apt-get install git


byobu-launcher-install
ssh-import-id nobuto

sudo visudo -f /etc/sudoers.d/nobuto
nobuto ALL=(ALL) NOPASSWD: ALL

sudo apt-add-repository ppa:maas-sailor/ppa
sudo apt-get update
sudo apt-get install maas-sailor

sudo apt-get install --no-install-recommends squid-deb-proxy

cat << EOF | sudo debconf-set-selections
squid-deb-proxy squid-deb-proxy/ppa-enable boolean true
unattended-upgrades unattended-upgrades/enable_auto_updates boolean true
EOF

sudo dpkg-reconfigure -fnoninteractive squid-deb-proxy
sudo dpkg-reconfigure -fnoninteractive unattended-upgrades

echo manual | sudo tee /etc/init/squid3.override

echo maas.ubuntu.com | sudo tee /etc/squid-deb-proxy/mirror-dstdomain.acl.d/90-maas
echo packages.elasticsearch.org | sudo tee /etc/squid-deb-proxy/mirror-dstdomain.acl.d/50-other

cat <<"EOF" | sudo tee -a /etc/squid-deb-proxy/squid-deb-proxy.conf

# maas.ubuntu.com
refresh_pattern index\.sjson$ 0 0% 0
refresh_pattern \/(boot|di)-kernel$ 129600 100% 129600
refresh_pattern root-image\.gz$ 129600 100% 129600
refresh_pattern \/(boot|di)-initrd$ 129600 100% 129600

refresh_pattern current\/grubnetx64\.efi\.signed$ 129600 0% 129600
EOF

sudo restart squid-deb-proxy

/etc/apt/apt.conf.d/90proxy
Acquire::http::proxy "http://10.81.0.1:8000/";

sudo apt-get update
sudo apt-get dist-upgrade

maas-sailor --debug --demo
ssh-keygen

maas-sailor --debug --demo


ssh-keygen -f ~/.ssh/id_rsa.localhost
cat ~/.ssh/id_rsa.localhost.pub >> ~/.ssh/authorized_keys
ln -s ~/.ssh/authorized_keys ~/.ssh/id_rsa.pub


# swap
sudo fallocate -l 8G /swapfile
sudo chmod 0600 /swapfile
sudo mkswap /swapfile
/etc/fstab
/swapfile none swap sw 0 0

sudo swapon /swapfile

sudo apt-get install htop
#sudo apt-get install ntp


sudo apt-get install munin munin-libvirt-plugins apache2 libapache2-mod-fcgid libcgi-fast-perl

#sudo sed -i -e 's/Require local/Require all granted/' /etc/munin/apache24.conf
sudo sed -i -e 's/Order allow,deny/Require all granted/;/Allow from localhost 127.0.0.0\/8 ::1/d' /etc/munin/apache.conf

sudo service apache2 reload

/etc/munin/plugin-conf.d/squid
[squid_*]
env.squidport 8000

sudo munin-node-configure --shell | sudo sh
sudo service munin-node restart

sudo munin-libvirt-plugins-detect --restart

/etc/cron.d/munin
*/1 * * * *     munin if [ -x /usr/bin/munin-cron ]; then /usr/bin/munin-cron; fi

/etc/munin/munin-conf.d/update_rate
#http://serverfault.com/questions/394878/can-munin-be-configured-to-display-hourly-graphs
update_rate 60
graph_data_size custom 480, 5 576, 30 432, 120 540, 1440 450

sudo service munin-node restart

sudo rm -v /var/lib/munin/localdomain/*.rrd


/etc/squid-deb-proxy/squid-deb-proxy.conf
# Only allow cachemgr access from localhost
http_access allow localhost manager
http_access deny manager

sudo service squid-deb-proxy restart

alias pushb


$ cat /etc/sysctl.d/99-local.conf 
vm.swappiness = 10

sudo apt-get install ccze
sudo apt-get install juju-deployer
#sudo apt-get install juju-core

~/.ssh/config
Host maas-sailor
    Hostname 10.81.0.2
    IdentityFile ~/.maas-sailor/ssh/id_rsa

Host 10.81.*.*
    User ubuntu
    StrictHostKeyChecking no
    UserKnownHostsFile /dev/null


sudo apt-get install uvtool-libvirt --no-install-recommends


sudo apt-get install autopkgtest --no-install-recommends

sudo adt-buildvm-ubuntu-cloud -v --disk-size 64G --proxy 'http://10.81.0.1:8000/' --release trusty --arch amd64

sudo eatmydata adt-run --unbuilt-tree maas-sailor/ -o adt-logs/ --timeout-test 21600 --- qemu --ram-size 16384 adt-trusty-amd64-cloud.img; pushb

sudo apt-get install jnettop
sudo apt-get install eatmydata


sudo apt-get install linux-crashdump

sudo sed -i -e 's/^\(USE_KDUMP=\).*/\11/' /etc/default/kdump-tools
sudo reboot


sudo apt-get install virt-top


# munin for maas
libdbd-pg-perl

git clone https://github.com/munin-monitoring/contrib.git

sudo mkdir -p /etc/munin/contrib/
sudo find contrib/plugins/ -type f -exec cp -v {} /etc/munin/contrib/ \;

sudo munin-node-configure --suggest
sudo munin-node-configure --suggest --libdir /etc/munin/contrib/
