---
- name: disable lid-close suspend, but lock
  blockinfile:
    dest: /etc/systemd/logind.conf
    block: |
      HandleLidSwitch=lock
      HandleLidSwitchExternalPower=lock
  become: yes

- name: disable IR camera
  copy:
    src: files/99-local-disable-ir-camera.rules
    dest: /etc/udev/rules.d/99-local-disable-ir-camera.rules
  become: yes

- name: install TLP
  apt:
    name: tlp
  become: yes

- name: update TLP config
  blockinfile:
    path: /etc/default/tlp
    block: |
      # ------------------------------------------------------------------------------
      RESTORE_DEVICE_STATE_ON_STARTUP=1
      START_CHARGE_THRESH_BAT1=80
      STOP_CHARGE_THRESH_BAT1=95
  become: yes
